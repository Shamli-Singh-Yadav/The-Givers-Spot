<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>The Givers' Spot - Appwrite</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://unpkg.com/appwrite@13.0.0"></script>
<style>
Â  * {
Â  Â  box-sizing: border-box;
Â  }
Â  body {
Â  Â  font-family: 'Poppins', sans-serif;
Â  Â  margin: 0;
Â  Â  background: var(--bg);
Â  Â  color: var(--text);
Â  Â  transition: background 0.5s ease, color 0.5s ease;
Â  }

Â  :root {
Â  Â  --green: #16a34a;
Â  Â  --green-dark: #15803d;
Â  Â  --accent: #22c55e;
Â  Â  --bg: #f9fafb;
Â  Â  --card: rgba(255, 255, 255, 0.9);
Â  Â  --text: #111827;
Â  }

Â  body.dark {
Â  Â  --bg: #0f172a;
Â  Â  --card: rgba(30, 41, 59, 0.9);
Â  Â  --text: #f9fafb;
Â  }

Â  header {
Â  Â  background: linear-gradient(120deg, var(--green-dark), var(--accent), #86efac);
Â  Â  color: white;
Â  Â  text-align: center;
Â  Â  padding: 3rem 1rem 2rem;
Â  Â  position: relative;
Â  Â  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
Â  }

Â  header h1 {
Â  Â  font-size: 3rem;
Â  Â  font-weight: 700;
Â  Â  margin: 0;
Â  }

Â  header p {
Â  Â  font-weight: 500;
Â  Â  opacity: 0.9;
Â  }

Â  #themeToggle {
Â  Â  position: absolute;
Â  Â  top: 20px;
Â  Â  right: 20px;
Â  Â  background: var(--card);
Â  Â  color: var(--green-dark);
Â  Â  border: none;
Â  Â  border-radius: 30px;
Â  Â  padding: 10px 18px;
Â  Â  cursor: pointer;
Â  Â  font-weight: 600;
Â  Â  transition: all 0.3s ease;
Â  Â  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
Â  }

Â  #themeToggle:hover {
Â  Â  background: var(--green);
Â  Â  color: white;
Â  }

Â  .container {
Â  Â  max-width: 1000px;
Â  Â  margin: -40px auto 50px;
Â  Â  background: var(--card);
Â  Â  backdrop-filter: blur(15px);
Â  Â  border-radius: 20px;
Â  Â  padding: 2.5rem;
Â  Â  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
Â  }

Â  h2 {
Â  Â  color: var(--green-dark);
Â  Â  margin-top: 0;
Â  Â  padding-bottom: 10px;
Â  Â  border-bottom: 2px solid rgba(22, 163, 74, 0.2);
Â  }

Â  label {
Â  Â  display: block;
Â  Â  font-weight: 600;
Â  Â  margin-top: 15px;
Â  Â  color: var(--text);
Â  }

Â  input[type="text"],
Â  textarea,
Â  select,
Â  #searchBar {
Â  Â  width: 100%;
Â  Â  padding: 14px;
Â  Â  border-radius: 10px;
Â  Â  border: 1px solid #d1d5db;
Â  Â  background: var(--bg);
Â  Â  color: var(--text);
Â  Â  font-size: 1rem;
Â  Â  margin-top: 5px;
Â  Â  transition: border-color 0.3s ease, background 0.3s ease;
Â  }
Â Â 
Â  input:focus, textarea:focus, select:focus, #searchBar:focus {
Â  Â  Â  border-color: var(--green);
Â  Â  Â  outline: none;
Â  Â  Â  box-shadow: 0 0 0 3px rgba(22, 163, 74, 0.3);
Â  }

Â  input[type="file"] {
Â  Â  margin-top: 10px;
Â  Â  padding: 10px 0;
Â  }

Â  button[type="submit"], .actions button {
Â  Â  background: var(--green);
Â  Â  border: none;
Â  Â  color: white;
Â  Â  font-weight: 600;
Â  Â  padding: 12px 20px;
Â  Â  border-radius: 10px;
Â  Â  margin-top: 15px;
Â  Â  cursor: pointer;
Â  Â  transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.2s ease;
Â  }

Â  button[type="submit"]:hover, .actions button:hover {
Â  Â  background: var(--green-dark);
Â  Â  transform: translateY(-2px);
Â  Â  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
Â  }

Â  #preview {
Â  Â  width: 150px;
Â  Â  height: 150px;
Â  Â  border-radius: 12px;
Â  Â  margin-top: 15px;
Â  Â  object-fit: cover;
Â  Â  display: none;
Â  Â  border: 2px solid var(--accent);
Â  }

Â  #searchBar {
Â  Â  margin-bottom: 10px;
Â  }

Â  .filter {
Â  Â  margin-top: 15px;
Â  Â  display: flex;
Â  Â  justify-content: flex-end;
Â  }

Â  .item-list {
Â  Â  margin-top: 2rem;
Â  }

Â  .item {
Â  Â  display: flex;
Â  Â  gap: 1.5rem;
Â  Â  background: var(--card);
Â  Â  border-radius: 16px;
Â  Â  padding: 1.5rem;
Â  Â  margin-bottom: 1.5rem;
Â  Â  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
Â  Â  border: 1px solid rgba(22, 163, 74, 0.1);
Â  Â  transform: translateY(10px);
Â  Â  opacity: 0;
Â  Â  animation: fadeIn 0.5s forwards;
Â  Â  transition: transform 0.3s ease, box-shadow 0.3s ease;
Â  }

Â  .item:hover {
Â  Â  Â  transform: translateY(-5px);
Â  Â  Â  box-shadow: 0 8px 25px rgba(0,0,0,0.1);
Â  }

Â  @keyframes fadeIn {
Â  Â  to { transform: translateY(0); opacity: 1; }
Â  }

Â  .item img {
Â  Â  width: 130px;
Â  Â  height: 130px;
Â  Â  border-radius: 12px;
Â  Â  object-fit: cover;
Â  Â  flex-shrink: 0;
Â  }

Â  .item-content {
Â  Â  flex: 1;
Â  Â  min-width: 200px;
Â  }

Â  .item h3 {
Â  Â  margin: 0 0 5px 0;
Â  Â  font-size: 1.5rem;
Â  Â  color: var(--green-dark);
Â  }

Â  .item small {
Â  Â  color: #6b7280;
Â  Â  display: block;
Â  Â  margin-bottom: 10px;
Â  }

Â  .item p {
Â  Â  margin: 5px 0 15px;
Â  }

Â  .actions {
Â  Â  display: flex;
Â  Â  gap: 10px;
Â  Â  margin-top: 10px;
Â  }

Â  .remove-btn {
Â  Â  background: #dc2626;
Â  }

Â  .remove-btn:hover {
Â  Â  background: #b91c1c;
Â  }

Â  .share-btn {
Â  Â  background: #2563eb;
Â  }

Â  .share-btn:hover {
Â  Â  background: #1d4ed8;
Â  }
Â Â 
Â  .status-message {
Â  Â  Â  padding: 10px;
Â  Â  Â  margin-top: 10px;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  font-weight: 600;
Â  Â  Â  display: none;
Â  }
Â Â 
Â  .status-message.success {
Â  Â  Â  background-color: #dcfce7;
Â  Â  Â  color: #15803d;
Â  }
Â Â 
Â  .status-message.error {
Â  Â  Â  background-color: #fee2e2;
Â  Â  Â  color: #b91c1c;
Â  }

Â  footer {
Â  Â  text-align: center;
Â  Â  padding: 30px;
Â  Â  color: #6b7280;
Â  }

Â  @media (max-width: 700px) {
Â  Â  .item {
Â  Â  Â  flex-direction: column;
Â  Â  Â  text-align: center;
Â  Â  Â  align-items: center;
Â  Â  }
Â  Â  .item-content { text-align: center; }
Â  }
</style>
</head>
<body>
<header>
Â  <h1>The Givers' Spot</h1>
Â  <p>Give what you can, take what you need ğŸŒ±</p>
Â  <button id="themeToggle">ğŸŒ™ Dark Mode</button>
</header>

<div class="container">
Â  <h2>â• Post an Item</h2>
Â  <form id="itemForm">
Â  Â  <label>Item Name</label>
Â  Â  <input type="text" id="itemName" placeholder="e.g. Wooden Chair" required>

Â  Â  <label>Description</label>
Â  Â  <textarea id="itemDesc" rows="4" placeholder="Condition, pickup, etc." required></textarea>

Â  Â  <label>Category</label>
Â  Â  <select id="itemCategory">
Â  Â  Â  <option>Books ğŸ“š</option>
Â  Â  Â  <option>Clothing ğŸ‘•</option>
Â  Â  Â  <option>Toys ğŸ§¸</option>
Â  Â  Â  <option>Electronics ğŸ”Œ</option>
Â  Â  Â  <option>Furniture ğŸª‘</option>
Â  Â  Â  <option>Other ğŸ</option>
Â  Â  </select>

Â  Â  <label>Photo (optional)</label>
Â  Â  <input type="file" id="itemPhoto" accept="image/*">
Â  Â  <img id="preview" alt="Preview">

Â  Â  <button type="submit">Post Item</button>
Â  Â  <div id="postStatus" class="status-message"></div>
Â  </form>

Â  <hr style="margin-top: 30px; border: 0; border-top: 1px solid #ccc;">

Â  <h2>âœ¨ Available Items</h2>
Â  <input type="text" id="searchBar" placeholder="ğŸ” Search items by name...">
Â  <div class="filter">
Â  Â  <select id="filterCategory">
Â  Â  Â  <option value="all">All Categories</option>
Â  Â  Â  <option value="Books ğŸ“š">Books ğŸ“š</option>
Â  Â  Â  <option value="Clothing ğŸ‘•">Clothing ğŸ‘•</option>
Â  Â  Â  <option value="Toys ğŸ§¸">Toys ğŸ§¸</option>
Â  Â  Â  <option value="Electronics ğŸ”Œ">Electronics ğŸ”Œ</option>
Â  Â  Â  <option value="Furniture ğŸª‘">Furniture ğŸª‘</option>
Â  Â  Â  <option value="Other ğŸ">Other ğŸ</option>
Â  Â  </select>
Â  </div>

Â  <div class="item-list" id="itemList">
Â  Â  <p id="loadingText" style="text-align: center; font-style: italic; color: #6b7280;">Loading items...</p>
Â  Â  <p id="emptyText" style="display: none; text-align: center; font-style: italic; color: #6b7280;">No items yet. Post something to get started!</p>
Â  </div>
</div>

<footer>Â© 2025 The Givers' Spot | Made with ğŸ’š and Appwrite</footer>

<script>
Â  // Appwrite Configuration - REPLACE THESE WITH YOUR ACTUAL IDS
Â  const APPWRITE_ENDPOINT = 'https://fra.cloud.appwrite.io/v1';Â Â 
Â  const APPWRITE_PROJECT_ID = '68f989ef00266a9a3c42';
Â  const APPWRITE_DATABASE_ID = '68f98b07003c6a5faf81';
Â  const APPWRITE_COLLECTION_ID = 'free_items_details_';
Â  const APPWRITE_BUCKET_ID = '68faeb91003d29583348';

Â  const { Client, Databases, ID, Query, Storage } = Appwrite;

Â  const client = new Client();
Â  client
Â  Â  .setEndpoint(APPWRITE_ENDPOINT)
Â  Â  .setProject(APPWRITE_PROJECT_ID);

Â  const databases = new Databases(client);
Â  const storage = new Storage(client);

Â  // --- DOM Elements ---
Â  const form = document.getElementById("itemForm");
Â  const itemList = document.getElementById("itemList");
Â  const emptyText = document.getElementById("emptyText");
Â  const loadingText = document.getElementById("loadingText");
Â  const photoInput = document.getElementById("itemPhoto");
Â  const preview = document.getElementById("preview");
Â  const searchBar = document.getElementById("searchBar");
Â  const filterCategory = document.getElementById("filterCategory");
Â  const themeToggle = document.getElementById("themeToggle");
Â  const postStatus = document.getElementById("postStatus");

Â  let items = [];

Â  // --- Utility Functions ---

Â  function showStatus(type, message) {
Â  Â  Â  postStatus.className = `status-message ${type}`;
Â  Â  Â  postStatus.textContent = message;
Â  Â  Â  postStatus.style.display = 'block';
Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  postStatus.style.display = 'none';
Â  Â  Â  }, 3000);
Â  }

Â  function getImageUrl(fileId) {
Â  Â  Â  return `${APPWRITE_ENDPOINT}/storage/buckets/${APPWRITE_BUCKET_ID}/files/${fileId}/preview?project=${APPWRITE_PROJECT_ID}&quality=75`;
Â  }

Â  function formatTime(timestamp) {
Â  Â  Â  const date = new Date(timestamp);
Â  Â  Â  return date.toLocaleString();
Â  }

Â  // --- Appwrite Logic ---

Â  async function getItems() {
Â  Â  Â  loadingText.style.display = 'block';
Â  Â  Â  try {
Â  Â  Â  Â  Â  // 1. Build Query Array
Â  Â  Â  Â  Â  const queries = [Query.orderDesc('$createdAt')];
Â  Â  Â  Â  Â  const search = searchBar.value.trim().toLowerCase();
Â  Â  Â  Â  Â  const filter = filterCategory.value;

Â  Â  Â  Â  Â  if (search) {
Â  Â  Â  Â  Â  Â  Â  queries.push(Query.search('name', search));
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  if (filter !== "all") {
Â  Â  Â  Â  Â  Â  Â  queries.push(Query.equal('category', filter));
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  // 2. Fetch data from Appwrite
Â  Â  Â  Â  Â  const response = await databases.listDocuments(
Â  Â  Â  Â  Â  Â  Â  APPWRITE_DATABASE_ID,
Â  Â  Â  Â  Â  Â  Â  APPWRITE_COLLECTION_ID,
Â  Â  Â  Â  Â  Â  Â  queries
Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  items = response.documents.map(doc => ({
Â  Â  Â  Â  Â  Â  Â  id: doc.$id,
Â  Â  Â  Â  Â  Â  Â  name: doc.name,
Â  Â  Â  Â  Â  Â  Â  // Using 'description' to match the fixed DB attribute
Â  Â  Â  Â  Â  Â  Â  desc: doc.description || doc.desc, 
Â  Â  Â  Â  Â  Â  Â  category: doc.category,
Â  Â  Â  Â  Â  Â  Â  fileId: doc.fileId,
Â  Â  Â  Â  Â  Â  Â  // Using 'datePosted' for display time
Â  Â  Â  Â  Â  Â  Â  time: doc.datePosted || doc.$createdAt, 
Â  Â  Â  Â  Â  }));
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  renderItems();

Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  console.error("Error fetching items:", error);
Â  Â  Â  Â  Â  loadingText.textContent = "Error loading items. Check console for details.";
Â  Â  Â  } finally {
Â  Â  Â  Â  Â  loadingText.style.display = 'none';
Â  Â  Â  }
Â  }

Â  // --- UI Rendering ---

Â  function renderItems() {
Â  Â  document.querySelectorAll(".item").forEach(e => e.remove());

Â  Â  if (items.length === 0) {
Â  Â  Â  emptyText.style.display = "block";
Â  Â  } else {
Â  Â  Â  emptyText.style.display = "none";
Â  Â  }

Â  Â  items.forEach((item, index) => {
Â  Â  Â  const div = document.createElement("div");
Â  Â  Â  div.className = "item";
Â  Â  Â  const imageUrl = item.fileId ? getImageUrl(item.fileId) : 'https://via.placeholder.com/130?text=No+Photo';
Â  Â  Â Â 
Â  Â  Â  div.innerHTML = `
Â  Â  Â  Â  <img src="${imageUrl}" alt="${item.name}">
Â  Â  Â  Â  <div class="item-content">
Â  Â  Â  Â  Â  <h3>${item.name}</h3>
Â  Â  Â  Â  Â  <small>${item.category} â€¢ Posted on ${formatTime(item.time)}</small>
Â  Â  Â  Â  Â  <p>${item.desc}</p>
Â  Â  Â  Â  Â  <div class="actions">
Â  Â  Â  Â  Â  Â  <button class="share-btn" data-id="${item.id}">Share</button>
Â  Â  Â  Â  Â  Â  <button class="remove-btn" data-id="${item.id}">Remove</button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  `;
Â  Â  Â  itemList.appendChild(div);
Â  Â  });

Â  Â  // Attach listeners for remove and share buttons
Â  Â  document.querySelectorAll(".remove-btn").forEach(btn => {
Â  Â  Â  btn.addEventListener("click", async (e) => {
Â  Â  Â  Â  const itemId = e.target.dataset.id;
Â  Â  Â  Â  if (confirm("Are you sure you want to remove this item?")) {
Â  Â  Â  Â  Â  Â  await removeItem(itemId);
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  });

Â  Â  document.querySelectorAll(".share-btn").forEach(btn => {
Â  Â  Â  btn.addEventListener("click", e => {
Â  Â  Â  Â  const item = items.find(i => i.id === e.target.dataset.id);
Â  Â  Â  Â  if (!item) return;

Â  Â  Â  Â  const text = `ğŸ ${item.name}\n${item.desc}\nCategory: ${item.category}\n-- Shared from The Givers' Spot`;
Â  Â  Â  Â  navigator.clipboard.writeText(text);
Â  Â  Â  Â  btn.textContent = "âœ… Copied!";
Â  Â  Â  Â  setTimeout(() => btn.textContent = "Share", 1500);
Â  Â  Â  });
Â  Â  });
Â  }

Â  // --- Event Handlers ---

Â  async function postItem(e) {
Â  Â  e.preventDefault();
Â  Â  const submitButton = form.querySelector('button[type="submit"]');
Â  Â  submitButton.disabled = true;
Â  Â  submitButton.textContent = 'Posting...';

Â  Â  const name = document.getElementById("itemName").value.trim();
Â  Â  const desc = document.getElementById("itemDesc").value.trim();
Â  Â  const category = document.getElementById("itemCategory").value;
Â  Â  const file = photoInput.files[0];
Â  Â  let fileId = null;

Â  Â  // --- ADDED: 5MB File Size Check ---
Â  Â  const MAX_FILE_SIZE = 5 * 1024 * 1024; // 5MB Limit in Bytes (Adjust if your Appwrite limit is different)

Â  Â  if (file && file.size > MAX_FILE_SIZE) {
Â  Â  Â  Â  showStatus('error', `à¤«à¤¼à¤¾à¤‡à¤² à¤¸à¤¾à¤‡à¤œà¤¼ à¤¬à¤¹à¥à¤¤ à¤¬à¤¡à¤¼à¤¾ à¤¹à¥ˆà¥¤ à¤…à¤§à¤¿à¤•à¤¤à¤® à¤¸à¤¾à¤‡à¤œà¤¼ ${MAX_FILE_SIZE / (1024 * 1024)}MB à¤¹à¥ˆà¥¤`);
Â  Â  Â  Â  submitButton.disabled = false;
Â  Â  Â  Â  submitButton.textContent = 'Post Item';
Â  Â  Â  Â  return; 
Â  Â  }
Â  Â  // --- End File Size Check ---

Â  Â  try {
Â  Â  Â  Â  if (file) {
Â  Â  Â  Â  Â  Â  // 1. Upload File to Appwrite Storage
Â  Â  Â  Â  Â  Â  const uploadedFile = await storage.createFile(
Â  Â  Â  Â  Â  Â  Â  Â  APPWRITE_BUCKET_ID,
Â  Â  Â  Â  Â  Â  Â  Â  ID.unique(),
Â  Â  Â  Â  Â  Â  Â  Â  file
Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  fileId = uploadedFile.$id;
Â  Â  Â  Â  }

Â  Â  Â  Â  // 2. Create Document in Appwrite Database
Â  Â  Â  Â  const payload = {
Â  Â  Â  Â  Â  Â  name,
Â  Â  Â  Â  Â  Â  description: desc, // FIXED: Using 'description' to match Appwrite DB attribute
Â  Â  Â  Â  Â  Â  category,
Â  Â  Â  Â  Â  Â  fileId: fileId,
Â  Â  Â  Â  Â  Â  datePosted: new Date().toISOString(), // FIXED: Added required 'datePosted' attribute
Â  Â  Â  Â  };

Â  Â  Â  Â  await databases.createDocument(
Â  Â  Â  Â  Â  Â  APPWRITE_DATABASE_ID,
Â  Â  Â  Â  Â  Â  APPWRITE_COLLECTION_ID,
Â  Â  Â  Â  Â  Â  ID.unique(),
Â  Â  Â  Â  Â  Â  payload
Â  Â  Â  Â  );
Â  Â  Â  Â Â 
Â  Â  Â  Â  showStatus('success', 'Item posted successfully!');

Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("Error posting item:", error);
Â  Â  Â  Â  showStatus('error', 'Failed to post item. Check console.');
Â  Â  } finally {
Â  Â  Â  Â  // Reset form and UI elements
Â  Â  Â  Â  form.reset();
Â  Â  Â  Â  preview.style.display = "none";
Â  Â  Â  Â  photoInput.value = null;
Â  Â  Â  Â  submitButton.disabled = false;
Â  Â  Â  Â  submitButton.textContent = 'Post Item';
Â  Â  Â  Â  getItems(); // Refresh the list
Â  Â  }
Â  }
Â Â 
Â  async function removeItem(itemId) {
Â  Â  Â  try {
Â  Â  Â  Â  Â  const itemToDelete = items.find(i => i.id === itemId);

Â  Â  Â  Â  Â  // 1. Delete Document
Â  Â  Â  Â  Â  await databases.deleteDocument(
Â  Â  Â  Â  Â  Â  Â  APPWRITE_DATABASE_ID,
Â  Â  Â  Â  Â  Â  Â  APPWRITE_COLLECTION_ID,
Â  Â  Â  Â  Â  Â  Â  itemId
Â  Â  Â  Â  Â  );

Â  Â  Â  Â  Â  // 2. Delete FileÂ 
Â  Â  Â  Â  Â  if (itemToDelete && itemToDelete.fileId) {
Â  Â  Â  Â  Â  Â  Â  await storage.deleteFile(
Â  Â  Â  Â  Â  Â  Â  Â  Â  APPWRITE_BUCKET_ID,
Â  Â  Â  Â  Â  Â  Â  Â  Â  itemToDelete.fileId
Â  Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  showStatus('success', 'Item removed successfully!');

Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  console.error("Error deleting item:", error);
Â  Â  Â  Â  Â  showStatus('error', 'Failed to remove item. Check console.');
Â  Â  Â  }
Â  }

Â  // --- Real-time Updates ---
Â  function subscribeToUpdates() {
Â  Â  Â  client.subscribe(`databases.${APPWRITE_DATABASE_ID}.collections.${APPWRITE_COLLECTION_ID}.documents`, response => {
Â  Â  Â  Â  Â  if (response.events.includes("databases.*.collections.*.documents.*.create") ||
Â  Â  Â  Â  Â  Â  Â  response.events.includes("databases.*.collections.*.documents.*.delete")) {
Â  Â  Â  Â  Â  Â  Â  getItems();Â 
Â  Â  Â  Â  Â  }
Â  Â  Â  });
Â  }


Â  // --- Event Listeners and Initial Load ---

Â  // Image Preview
Â  photoInput.addEventListener("change", () => {
Â  Â  const file = photoInput.files[0];
Â  Â  if (file) {
Â  Â  Â  const reader = new FileReader();
Â  Â  Â  reader.onload = e => {
Â  Â  Â  Â  preview.src = e.target.result;
Â  Â  Â  Â  preview.style.display = "block";
Â  Â  Â  };
Â  Â  Â  reader.readAsDataURL(file);
Â  Â  } else {
Â  Â  Â  Â  preview.style.display = "none";
Â  Â  }
Â  });

Â  // Theme Toggle
Â  themeToggle.addEventListener("click", () => {
Â  Â  document.body.classList.toggle("dark");
Â  Â  const dark = document.body.classList.contains("dark");
Â  Â  themeToggle.textContent = dark ? "â˜€ï¸ Light Mode" : "ğŸŒ™ Dark Mode";
Â  Â  localStorage.setItem('theme', dark ? 'dark' : 'light');
Â  });
Â Â 
Â  // Load saved theme
Â  const savedTheme = localStorage.getItem('theme') || 'light';
Â  if (savedTheme === 'dark') {
Â  Â  Â  document.body.classList.add('dark');
Â  Â  Â  themeToggle.textContent = "â˜€ï¸ Light Mode";
Â  } else {
Â  Â  Â  themeToggle.textContent = "ğŸŒ™ Dark Mode";
Â  }

Â  // Form Submission
Â  form.addEventListener("submit", postItem);

Â  // Search and Filter (trigger a re-fetch and re-render)
Â  searchBar.addEventListener("input", getItems);
Â  filterCategory.addEventListener("change", getItems);

Â  // Initial load of items and subscription setup
Â  getItems();
Â  subscribeToUpdates();
</script>
</body>

</html>
